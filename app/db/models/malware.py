from app.db import db


class Malware(db.Model):
    __tablename__ = 'urllookup'
    id = db.Column(db.Integer, primary_key=True)
    host = db.Column(db.String(200))
    path = db.Column(db.String(200))
    dtime = db.Column(db.DateTime, default=None)

    @classmethod
    def _set_return_value(cls, data, is_safe):
        response = {
            "url": f"",
            "is_safe": is_safe,
            "data": {
                "host": f"{data['host']}".split(':')[0],
                "port": f"{data['host']}".split(':')[1] if len(f"{data['host']}".split(':')) > 1 else "",
                "path": f"{data['path']}"
            }
        }
        return response
