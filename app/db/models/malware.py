from app.db import db


class Malware(db.Model):
    __tablename__ = 'urllookup'
    id = db.Column(db.Integer, primary_key=True)
    url = db.Column(db.String(200), unique=True)
    dtime = db.Column(db.DateTime, default=None)

    @classmethod
    def _set_return_value(cls, data, is_safe):
        response = {
            "is_safe": is_safe,
            "data": {
                "url": f"http://{data['url']}" if is_safe else "Forbidden"
            }
        }
        return response
